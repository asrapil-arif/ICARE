@*draft style*@
<style>

	mandatory {
		color: red;
	}

	.template_e_contract {
		overflow-y: scroll;
		width: 100%;
		padding: 2%;
		padding-top: 0px;
		border-radius: 0px;
		text-align: justify;
		border: none;
		border-bottom: 1px solid #dedede;
		background-color: whitesmoke;
		display: inline-grid;
		position: relative;
		margin: 0% auto;
	}

	.outer_page_drafting_v2 {
		overflow-y: auto;
		margin: 0px auto;
		width: 100%;
		padding: 2%;
		padding-top: 0px;
		border-radius: 0px;
		text-align: justify;
		border: 0px solid #dedede;
		border-bottom: 0px solid #dedede;
		border-top: 1px solid #dedede;
		background-color: whitesmoke;
	}

	.page {
		background-color: white;
		border: 1px solid #d2caca;
		margin: 2% auto;
		margin-top: 1%;
		margin-bottom: 1%;
		width: 874px;
		min-height:450px;
		position: relative;
		box-shadow: 13px 16px 13px -9px rgba(0,0,0,0.21);
		-webkit-box-shadow: 13px 16px 13px -9px rgba(0,0,0,0.21);
		-moz-box-shadow: 13px 16px 13px -9px rgba(0,0,0,0.21);
		overflow: hidden;
		padding: 5%;
	}

	.content_editor {
		min-height: 100%;
		width: 100%;
		padding: 1%;
		overflow: hidden;
	}

	.page_header {
		position: absolute;
		top: 0;
		right: 0;
		left: 0;
		padding: 5px;
		font-size: 12px;
		color: gray;
		width: 100%;
		text-align: right;
	}

	.page_footer {
		position: absolute;
		bottom: 0;
		right: 0;
		left: 0;
		font-style: italic;
		padding: 5px;
		font-size: 11px;
		color: gray;
		width: 100%;
		text-align: right;
	}

	.page_footer_sub {
		border-top: 1px solid #dedede;
		padding: 5px;
		margin: 2% auto;
		width: 90%;
	}

	.input_box_draft {
		border: none !important;
		padding: 0px;
		text-align: right;
		width: 100%;
	}

	.e_materai {
		font-weight: bold;
		color: #d6d3d3;
		border: 0px dashed #dedede;
		padding: 7%;
		text-align: center;
		width: 200px;
		font-size: 10px;
		background-color: #778287;
	}

	.nama_pt {
		font-weight: bold;
	}

	.baris_center {
		text-align: center !important;
	}

	.inner_template td {
		font-size: 12px !important;
	}

	.sub_page_doc {
		text-align: justify;
	}

	.page {
		font-size: 12px !important;
	}
</style>

@*css_drafting_tools*@
<style>

	.drafting_tools {
		background-color: #eaeaea;
		text-align: center;
		vertical-align: middle;
		border-top: 1px solid #d1cdcd;
		padding: 5px;
	}

	.btn-draft-tools {
		border-width: 1px !important;
		font-size: 11px;
		padding: 4px;
		border-radius: 2px;
	}

	.break_menu {
		border-left: 1px solid #d2caca;
		padding: 10px;
		padding-left: 3px;
		padding-right: 2px;
	}

	.pre_submit_wording {
		line-height: 25px;
		font-size: 13px !important;
	}


	#mandatory_value_confirm .select2 {
		font-size: 12px;
		text-align: left;
	}

	.preview_attachment {
		overflow-y: hidden;
		margin-top: 0px;
		margin-bottom: 0px;
		width: 100%;
		border-radius: 0px;
		text-align: justify;
		border: none;
		border-bottom: 0px solid #dedede;
		background-color: white;
		position: relative;
	}

	#frame_preview {
		background: url("../../Content/images/loading_images/conection.gif") center center no-repeat;
		background-color: white;
		background-size: 45%;
	}
</style>


@*css_daftar_lampiran*@
<style>

	#ModalListAttacment .modal-dialog {
		width: 60%;
		margin: 0 auto;
		margin-top: 5%;
		-webkit-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		-moz-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
	}

	#ModalDownloadDraft .modal-dialog {
		width: 30%;
		margin: 0 auto;
		margin-top: 9%;
		-webkit-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		-moz-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
	}



	#ModalDownloadDraft .icon_short_cut {
		padding: 10px;
		border: 1px dashed #dedede;
		height: 70px !important;
	}

		#ModalDownloadDraft .icon_short_cut .ace-icon {
			font-size: 35px !important;
		}

	#gridLampiran .icon-file {
		font-size: 20px;
	}



	#ModalUploadDraftManual .modal-dialog {
		width: 50%;
		margin: 0 auto;
		margin-top: 10%;
		-webkit-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		-moz-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
	}


	.bagi_dua {
		width: 50% !important;
		display: inline-block;
		float: left;
	}

	.preview_attachment {
		border-left: 1px solid #dedede;
	}

	.judul_preview_file {
		width: 100%;
		background: #efefed;
		border-top: 1px solid #dedede;
		padding: 10px;
		font-weight: bold;
	}

	.close_prev_ {
		color: red;
		cursor: pointer;
	}

		.close_prev_:hover {
			color: #ff6060;
		}

	.no_draft_icon {
		font-size: 55px;
		color: #325ca8;
		cursor: pointer;
	}

	.no_draft_icon:hover {
		opacity:.80;
	}

</style>

@*process*@
<style>

	#proses_next_step label {
		font-size: 12px;
	}

	#proses_next_step textarea {
		resize: none;
		min-height: 100px;
		width: 100%;
	}


	.pre_submit_wording, .form_mandatory {
		font-size: 18px;
		padding: 10px;
		width: 90%;
		margin: 1% auto;
		border-bottom: 0px solid #dedede;
		text-align: center;
	}

	.form_mandatory {
		padding: 1% !important;
		border-top: 1px solid #dedede;
		border-bottom: 1px solid #dedede;
	}

		.form_mandatory label {
			font-size: 12px;
		}
</style>

@*modal css*@
<style>

	#ModalRichText .modal-dialog {
		width: 90%;
		margin: 0 auto;
		margin-top: 5%;
		-webkit-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		-moz-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
	}

	#ModalCustomPoint .modal-dialog {
		width: 80%;
		margin: 0 auto;
		margin-top: 5%;
		-webkit-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		-moz-box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
		box-shadow: -1px 11px 48px 3px rgba(0,0,0,0.75);
	}

	#ModalCustomPoint .control-label {
		font-size: 12px;
	}

	#ModalInputMail .modal-dialog {
		width: 60%;
		margin: 0 auto;
		margin-top: 10%;
	}
	#ModalInputMail label {
		font-size:12px;
	}
</style>

@*hasil*@
<style>


	.result_wording {
		text-align: center;
		margin: 2% auto;
		margin-bottom: 5%;
		font-size: 15px;
		width: 80%;
		font-weight: bold
	}

	.group_file_kontrak {
		text-align: center
	}

	.icon_file_contract {
		border: 1px solid #dedede;
		padding: 20px;
		width: 130px;
		height: 140px;
		display: inline-table;
		margin-left: 5px;
		font-size: 12px;
		cursor: pointer;
		transition: 0.3s;
		margin-bottom: 1%;
		background-color: none;
		cursor: pointer;
		text-align: center
	}




		.icon_file_contract:hover {
			color: dodgerblue;
			border-color: dodgerblue;
			opacity: .80;
		}

		.icon_file_contract i {
			font-size: 45px !important;
			color: darkorange;
		}

	.icon_file_contract_red {
		border: 1px solid #dedede;
		padding: 20px;
		width: 130px;
		height: 140px;
		display: inline-table;
		margin-left: 5px;
		font-size: 12px;
		cursor: pointer;
		transition: 0.3s;
		margin-bottom: 1%;
		background-color: none;
		cursor: pointer;
		text-align: center
	}


		.icon_file_contract_red:hover {
			color: dodgerblue;
			border-color: dodgerblue;
			opacity: .80;
		}

		.icon_file_contract_red i {
			font-size: 45px !important;
			color: red;
		}

	.kata-kata {
		font-size: 15px;
	}
</style>

<style>
	.icon_pre {
		text-align:right;
		padding-right:0px;

	}
	@@media screen and (max-width: 992px) {

		.icon_pre {
			text-align: left;
			padding-right: unset;
		}
	}
	@@media screen and (max-width: 600px) {

		.icon_pre {
			text-align: left;
			padding-right: unset;
		}

	}

</style>

<div id="template_e_contract" hidden>

	<div class="drafting_tools" id="drafting_tools_draft">



	</div>

	<div class="outer_page_drafting_v2">


	</div>

</div>

<div id="uploader_file" hidden>

	<input type="file" id="attachment_draft_e_kontrak" required accept=".jpg,.jpeg,.pdf,.png,.xls" multiple	 />

</div>

<div id="add_new_draft_panel" hidden>

	<div class="pre_submit_wording row" hidden id="pre_process_wording" >

		<div class="box-body" style="text-align:left;">
			<div class="col-sm-1 icon_pre">
				<img src="../../../Content/img/contract_icon.png"  style="width:50px;">
			</div>
			<div class="col-sm-4 text-left">
				<span style="font-size:25px;">
					Add New Contract
				</span><br />
				<span style="font-size:15px;">Lengkapi data-data berikut !</span>
			</div>
		</div>
			
	</div>

	<div class="row form_mandatory" id="form_mandatory_prep">

		<form class="form-horizontal">
			<div class="box-body">



				<div class="form-group" id="idtext">
					<label for="inputName" class="col-sm-2 control-label">Judul Kontrak <mandatory>*</mandatory> :</label>
					<div class="col-sm-10">
						<input class="form-control wajib" id="EContractTitle" placeholder="Judul Kontrak" type="text" autocomplete="off" onkeypress="if (event.keyCode == 13){$('#EContractValue').focus();}">
					</div>
				</div>

				<div class="form-group">
					<label for="inputName" class="col-sm-2 control-label">Contract Value <mandatory>*</mandatory> :</label>
					<div class="col-sm-10">
						<input type="text" id="Etemp_ContractValue" hidden />
						<input class="form-control wajib" id="EContractValue" placeholder="Nilai kontrak" type="text" onselect="format_currency('EContractValue','Etemp_ContractValue')" onkeyup="format_currency('EContractValue','Etemp_ContractValue')" onmouseup="format_currency('EContractValue','Etemp_ContractValue')" autocomplete="off" onkeypress="if (event.keyCode == 13){$('#EFungsi').focus();}">
					</div>
				</div>


				<div class="form-group" style="text-align:left;font-size:12px;">

					<label for="inputName" class="col-sm-2 control-label">Fungsi <mandatory>*</mandatory> :</label>
					<div class="col-sm-10">

						<select class="form-control select2 wajib" id="EFungsi" placeholder="Fungsi">
							<option value="" selected>-- Pilih Fungsi --</option>
						</select>

						<script>

							var DataPerson = $.ajax({
								url: URL_PTPR + '/EContract/GetFungsiPtpr',
								type: 'GET',
								dataType: "json",
								cache: false,
								async: false,
								contentType: false,
								processData: false,
							});

							PersonDataList = DataPerson.responseJSON;

							$.each(PersonDataList, function (i, item) {

								$("#EFungsi").append('<option value="' + PersonDataList[i].ID + '">' + PersonDataList[i].ID + ' - ' + PersonDataList[i].NM_UNIT_ORG + '</option>');


							});

							$("#EFungsi").trigger("change");


						</script>

					</div>

				</div>

				<div class="form-group" style="text-align:left;font-size:12px;">

					<label for="inputName" class="col-sm-2 control-label">Contract Signing Officer <mandatory>*</mandatory> :</label>
					<div class="col-sm-10">

						<select class="form-control select2 wajib" id="EPerson" placeholder="Contract Signing Officer">
							<option value="" selected>-- Pilih Pic --</option>
						</select>

						<script>

							var DataPerson = $.ajax({
								url: URL_PTPR + '/EContract/GetPersonPtpr',
								type: 'GET',
								dataType: "json",
								cache: false,
								async: false,
								contentType: false,
								processData: false,
							});

							PersonDataList = DataPerson.responseJSON;

							$.each(PersonDataList, function (i, item) {

								$("#EPerson").append('<option value="' + PersonDataList[i].NIP + '">' + PersonDataList[i].NM_PEG + ' - ' + PersonDataList[i].NIP + ' - ' + PersonDataList[i].NM_JABATAN_STR + '</option>');


							});

							$("#EPerson").trigger("change");


						</script>

					</div>

				</div>

				<div class="form-group" style="text-align:left;font-size:12px;">

					<label for="inputName" class="col-sm-2 control-label">Contract Type <mandatory>*</mandatory> :</label>
					<div class="col-sm-10">

						<select class="form-control select2 wajib" id="EContractType" placeholder="Contract Type">
							<option value="" selected>-- Pilih Tipe Kontrak --</option>
						</select>

						<script>

							var DataContractType = $.ajax({
								url: URL_PTPR + '/EContract/GetContractType',
								type: 'GET',
								dataType: "json",
								cache: false,
								async: false,
								contentType: false,
								processData: false,
							});

							ContractTypeData = DataContractType.responseJSON;

							$.each(ContractTypeData, function (i, item) {

								$("#EContractType").append('<option value="' + ContractTypeData[i].Id + '">' + ContractTypeData[i].ContractType + '</option>');


							});

							$("#EContractType").trigger("change");


						</script>

					</div>

				</div>

				<div class="form-group">

					<label for="inputName" class="col-sm-2 control-label">Periode Periode Kontrak <mandatory>*</mandatory> :</label>
					<div class="col-sm-10">
						<div class="input-daterange input-group col-sm-10">

							<input type="text" class="input-sm form-control wajib" id="EStartDate" placeholder="Tgl. Kontrak Dimulai" autocomplete="off">
							<span class="input-group-addon">
								<i class="fa fa-long-arrow-right"></i>
							</span>

							<input type="text" class="input-sm form-control wajib" id="EEndDate" placeholder="Tgl. Kontrak Berakhir" autocomplete="off">
						</div>
					</div>
				</div>


				<div class="form-group" id="idtext">
					<label for="inputName" class="col-sm-2 control-label">Remark  :</label>
					<div class="col-sm-10">
						<textarea class="form-control input" placeholder="Tinggalkan keterangan jika diperlukan" id="Remark" style="color:#333;resize:none;font-size:11px;padding-left:3px;height:50px;" autocomplete="off"></textarea>
					</div>
				</div>

				<div class="form-group" id="idtext" style="text-align:left;">
					<label for="inputName" class="col-sm-2 control-label">Upload Draft Kontrak <mandatory>*</mandatory> :</label>
					<div class="col-sm-10">
						<input type="file" id="file_draft" required accept=".doc,.docx" class="uploader" />
					</div>
				</div>

				<div class="form-group" style="text-align:left;">
					<label for="inputName" class="col-sm-2 control-label">File Pendukung :</label>
					<div class="col-sm-10">
						<button type="button" class="btn btn-white btn-bold btn-draft-tools btn-clear-attach btn-attach-info" hidden>...</button>
						<button type="button" class="btn btn-white btn-bold btn-draft-tools btn-clear-attach" onclick="clear_attach_file()" hidden><i class="ace-icon fa fa-trash" aria-hidden="true"></i> Clear Attachment File</button>
						<button type="button" class="btn btn-white btn-bold btn-draft-tools" onclick="$('#attachment_draft_e_kontrak').click();"><i class="ace-icon fa fa-paperclip" aria-hidden="true" style="color:orange;"></i> Attach File</button>
					</div>
				</div>

			</div>
		</form>

	</div>


	<div class="pre_submit_wording row button_box_prep">
		<button type="button" class="btn btn-gray btn-sm" onclick="cancel_add()" ondblclick="cancel_add()"><i class="ace-icon fa fa-undo" aria-hidden="true"></i> Cancel</button>
		<button type="button" class="btn btn-primary btn-sm" onclick="isi_email_alert()" ondblclick="isi_email_alert()"><i class="ace-icon  fa fa-arrow-right" aria-hidden="true"></i> Next</button>
	</div>

</div>

<div id="proses_next_step_mail" hidden>

	<div class="pre_submit_wording row">

		<img src="~/Content/img/email_icon.png" style="width:5%;" /><br /><br />
		<span style="font-size:18px;font-weight:bold;">
			Setting Email Alert
		</span>
		<br />
		<span style="font-size:15px;">Agar Anda selalu mendapat notofikasi jika kontrak sudah mendekati end periode </span>

	</div>

	<div class="pre_submit_wording row">
		<div id="gridMail_add" style="width:100%; height:210px;border-radius:0px;text-align:left;"></div>
	</div>

	<div class="pre_submit_wording row button_box_prep">
		<button type="button" class="btn btn-gray btn-sm" onclick="back_from_isi_email()" ondblclick="back_from_isi_email()"><i class="ace-icon fa fa-arrow-left" aria-hidden="true"></i> Back</button>
		<button type="button" class="btn btn-primary btn-sm" onclick="submit_draft()" ondblclick="submit_draft()"><i class="ace-icon  fa fa-paper-plane" aria-hidden="true"></i> Submit</button>
	</div>

</div>

<div id="proses_next_step" hidden>

	<div class="pre_submit_wording row" hidden id="pre_process_wording">

		<img src="~/Content/img/document_check2.png" style="width:5%;" /><br />
		<span>
			Pastikan <b>DRAFT E-KONTRAK</b> yang akan Anda proses ini telah sesuai <br />
			atau Anda dapat memerikasa-nya kembali dan Anda juga
			dapat meninggkalkan catatan pada proses ini.
		</span>
		<br />
		<span id="next_step_wording" style="font-size:15px;"></span>

	</div>


	<div class="pre_submit_wording row" hidden id="pre_reject_wording">

		<img src="~/Content/img/reject_icon2.jpg" style="width:10%;" /><br />
		<span>
			Yakin mau mereject <b>DRAFT E-KONTRAK</b> ini ?<br />
			atau Anda dapat memerikasa-nya kembali dan Anda juga
			dapat meninggkalkan catatan pada proses ini.
		</span>
		<br />
		<span id="next_step_wording" style="font-size:15px;"></span>

	</div>

	<div class="row form_mandatory" id="form_mandatory_prep">
		<form class="form-horizontal">
			<div class="box-body">

				<div class="form-group">
					<label for="inputName" class="col-sm-2 control-label mandatory">Tinggalkan Catatan :</label>
					<div class="col-sm-10">
						<textarea class="form-control" id="ProcessCatatan" placeholder="Tinggalkan catatan jika diperlukan" autocomplete="off"></textarea>
					</div>
				</div>

				<div class="form-group cek_box" id="field_lanjut_dengan_catatan">
					<label for="inputName" class="col-sm-2 control-label mandatory">Lanjut Proses Dengan Catatan :</label>
					<div class="col-sm-10" style="text-align:left !important;">
						<label class="block">
							<input name="form-field-checkbox" id="ENeedCorrection" type="checkbox" class="ace input-lg">
							<span class="lbl bigger-120"> Dengan menchecklist ini proses akan dilanjutkan dengan catatan dan akan dikembalikan ke pembuat draft!</span>
						</label>
					</div>
				</div>


				<div class="form-group cek_box" id="field_unprocedural">
					<label for="inputName" class="col-sm-2 control-label mandatory">Tidak Sesuai Prosedur :</label>
					<div class="col-sm-10" style="text-align:left !important;">
						<label class="block">
							<input name="form-field-checkbox" id="EUnprocedural" type="checkbox" class="ace input-lg">
							<span class="lbl bigger-120"> Dengan menchecklist ini proses kontrak dianggap tidak sesuai prosedur dan akan langsung dimasukan ke list trash!</span>
						</label>
					</div>
				</div>

				<div class="form-group cek_box" id="field_update_draft">
					<label for="inputName" class="col-sm-2 control-label mandatory">Perbaharui Draft :</label>
					<div class="col-sm-10">
						<input type="file" id="file_draft" required accept=".doc,.docx" class="uploader" />
					</div>
				</div>


				<div class="form-group file_sign_upload_group">
					<label for="inputName" class="col-sm-2 control-label mandatory">Upload Signed Draft I <mandatory>*</mandatory>&nbsp;&nbsp;:</label>
					<div class="col-sm-10">
						<input type="file" id="ProcessUpload_1" required accept=".jpg,.jpeg,.pdf,.png,.xls" class="uploader" />
					</div>
				</div>

				<div class="form-group file_sign_upload_group">
					<label for="inputName" class="col-sm-2 control-label mandatory">Upload Signed Draft II <mandatory>*</mandatory>&nbsp;&nbsp;:</label>
					<div class="col-sm-10">
						<input type="file" id="ProcessUpload_2" required accept=".jpg,.jpeg,.pdf,.png,.xls" class="uploader" />
					</div>
				</div>

			</div>
		</form>
	</div>


	<div class="pre_submit_wording row button_box_prep">
		<button type="button" class="btn btn-gray btn-sm" onclick="back_to_drafting()" ondblclick="back_to_drafting()"><i class="ace-icon fa fa-arrow-left" aria-hidden="true"></i> Back</button>
		<button type="button" class="btn btn-primary btn-sm" onclick="submit_draft()" ondblclick="submit_draft()"><i class="ace-icon  fa fa-paper-plane" aria-hidden="true"></i> Next</button>
	</div>

</div>

<div class="page_progress" id="progress_save_draft" hidden>

	<img src="~/Content/images/loading_images/roket.gif" style="width:30%;" />
	<br />
	<span>Loading ...</span>

</div>

<!-- Modal -->
<div class="modal fade modal_ex" id="ModalListAttacment" role="dialog">
	<div class="modal-dialog modal-lg">
		<div class="modal-content" style="border:none;">
			<div class="modal-header">
				<h4 class="modal-title"> <i class="fa fa-paperclip" aria-hidden="true"></i> Daftar Lampiran</h4>

			</div>
			<div class="modal-body" style="padding:0px;">

				<div id="gridLampiran" style="height:298px;border:none;border-radius:0px;border-top:1px solid #ccc;border-right:0px solid #dedede;"></div>

			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Cancel</button>

			</div>
		</div>
	</div>
</div>

<div class="modal fade modal_ex" id="ModalDownloadDraft" role="dialog">
	<div class="modal-dialog modal-lg">
		<div class="modal-content" style="border:none;">
			<div class="modal-header">
				<h4 class="modal-title"> <i class="ace-icon fa fa-file-pdf-o" aria-hidden="true" style="color:red;"></i> Silahkan Download Draft Berikut !</h4>

			</div>
			<div class="modal-body" style="padding:0px;">

				<div id="box_info_icon" style="border:none !important;padding-bottom:15px !important;">


					<div class="icon_short_cut" onclick="download_draft(1);">
						<i class="ace-icon fa fa-file-pdf-o" aria-hidden="true" style="color:red;"></i>
						<br />
						<span class="lbl bigger-100">Draft Rangkap I</span> <br /><br />
					</div>


					<div class="icon_short_cut" onclick="download_draft(2);">
						<i class="ace-icon fa fa-file-pdf-o" aria-hidden="true" style="color:red;"></i>
						<br />
						<span class="lbl bigger-100">Draft Rangkap II</span> <br /><br />
					</div>

				</div>

			</div>
			<div class="modal-footer" style="text-align:center;">
				<button type="button" class="btn btn-gray btn-sm" data-dismiss="modal">Close</button>

			</div>
		</div>
	</div>
</div>

<!-- Modal -->
<div class="modal fade" id="ModalInputMail" role="dialog">
	<div class="modal-dialog modal-lg">

		<div class="modal-content" style="none;">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Input Email Alert</h4>

			</div>
			<div class="modal-body" style="padding:10px;">

				<form class="form-horizontal">
					<div class="box-body">


						<div class="form-group">

							<label for="inputName" class="col-sm-3 control-label">Nama Penerima <span style="color:Red;">*</span> : </label>
							<div class="col-sm-8">
								<input type="text" class="form-control date-picker wajib_diisi" id="penerima_email" placeholder="Nama" autocomplete="off" onkeypress="if (event.keyCode == 13){$('#brand').focus();}">
							</div>

						</div>

						<div class="form-group">

							<label for="inputName" class="col-sm-3 control-label">Alamat Email <span style="color:Red;">*</span> : </label>
							<div class="col-sm-8">
								<input type="text" class="form-control date-picker wajib_diisi" id="alamat_email" placeholder="Email" autocomplete="off" onkeypress="if (event.keyCode == 13){$('#start_date').focus();}">
							</div>

						</div>


						<div class="form-group">

							<label for="inputName" class="col-sm-3 control-label">Jabatan <span style="color:Red;">*</span> : </label>
							<div class="col-sm-8">
								<input type="text" class="form-control date-picker wajib_diisi" id="jabatan_penerima" placeholder="Jabatan" autocomplete="off" onkeypress="if (event.keyCode == 13){$('#start_date').focus();}">
							</div>

						</div>


					</div>
				</form>



			</div>
			<div class="modal-footer">

			</div>

		</div>
	</div>
</div>


<div class="modal fade modal_ex" id="ModalUploadDraftManual" role="dialog">
	<div class="modal-dialog modal-lg">
		<div class="modal-content" style="border:none;">
			<div class="modal-header">
				<h4 class="modal-title"> <i class="ace-icon fa fa-file-pdf-o" aria-hidden="true" style="color:red;"></i> Upload Draft E-Contract</h4>
			</div>
			<div class="modal-body" style="padding:10px;">
				<div id="manual_draft_upload_panel">
					<input type="file" id="file_draft_manual" required accept=".doc,.docx" class="uploader" />
				</div>

				<div class="alert alert-block alert-danger" hidden style="text-align:center;">
					<button type="button" class="close" onclick="$('#ModalUploadDraftManual .alert').hide();">
						<i class="ace-icon fa fa-times"></i>
					</button>
					<div class="pesan_error">...</div>
				</div>

				<div id="manual_draft_upload_process" hidden style="text-align:center;">
					<img src="~/Content/img/loading.gif" style="width:120px;"/>
					<br />Please wait ...
				</div>
			</div>

			<div class="modal-footer" style="text-align:center;">
				<button type="button" class="btn btn-primary btn-sm" onclick="upload_draft_manual_push()">Upload</button>
				<button type="button" class="btn btn-gray btn-sm" data-dismiss="modal">Cancel</button>

			</div>
		</div>
	</div>
</div>


@*variabel & Const*@
<script>

	var current_contract_id = "";
	var panel_height_ajustment = 170;
	var panel_height_ajustment_editor = 200;
	var curent_template = [];
	var page_ = 1;

	var current_contract = [];
	var current_formid = 0;
	var FlagSign = 0;
	var open_preview = 0;
	var current_reject = 0;
	var current_process = "";
	var IdSelect = "";


</script>

@*//Drafting Tools JS*@
<script>



	$('.outer_page_drafting_v2').css('height', (Number(window.innerHeight) - panel_height_ajustment));

	//$(window).resize(function () {

	//	$('.outer_page_drafting_v2').css('height', (Number(window.innerHeight) - panel_height_ajustment));

	//});



	function ViewDraft(Record) {

		current_contract = Record;
		current_contract_id = Record.ContractId;
		current_reject = 0;
		page_ = 1;
		full_screen_stat = 1;
		current_process = "PROCESS"
		css_color = "icon_file_contract";
		icon_download = "fa fa-file-text";
		link_down = "download_draft_v2";

		var file_input = $('#proses_next_step #file_draft');
		file_input.ace_file_input('reset_input');

		if (Record.InProcess == 4 || Record.InProcess == 6) {
			css_color = "icon_file_contract_red";
			icon_download = "fa fa-file-pdf-o";
			link_down = "download_draft_sign"
		}

		var file_1 = $('#ProcessUpload_1');
		var file_2 = $('#ProcessUpload_2');
		file_1.ace_file_input('reset_input');
		file_2.ace_file_input('reset_input');


		//get control
		var DataSave = new FormData();
		DataSave.append('ContractId', current_contract_id);
		var allow_button = $.ajax({
			url: URL_PTPR + '/Button/E_Kontrak_Procurement_AllowButton',
			type: 'POST',
			data: DataSave,
			dataType: "json",
			cache: false,
			async: false,
			contentType: false,
			processData: false,
		});

		//button_fixed = ' <button type="button" class="btn btn-white btn-bold btn-draft-tools full_screen_btn" onclick="full_screen(\'#template_e_contract\');"><i class="ace-icon fa fa-arrows-alt" aria-hidden="true"></i> Maximize</button>';
		//button_fixed = button_fixed + ' <button type="button" class="btn btn-white btn-bold btn-draft-tools" onclick="close_drafting();"><i class="ace-icon fa fa-times" aria-hidden="true" style="color:red;"></i> Close</button>';

		button_fixed = ' <button type="button" class="btn btn-white btn-bold btn-draft-tools" onclick="ViewLogContract();"><i class="ace-icon fa fa-history" aria-hidden="true" style="color:black;"></i> Log</button><button type="button" class="btn btn-white btn-bold btn-draft-tools" onclick="close_drafting();"><i class="ace-icon fa fa-times" aria-hidden="true" style="color:red;"></i> Close</button>';
		button_action = allow_button.responseText;
		button_lampiran = ' <button type="button" class="btn btn-white btn-bold btn-draft-tools" onclick="lihat_attachment()"><i class="ace-icon fa fa-paperclip" aria-hidden="true" style="color:orange;"></i> List Lampiran Tersedia</button>';

		$("#drafting_tools_draft").html('<div class="btn-group">' + button_lampiran + button_action + button_fixed + '</div>');

		$(".outer_page_drafting_v2").html("");
		$(".btn-clear-attach").hide();
		$(".main-content-inner .breadcrumb .active").html("E-Contract General Draft , #Contract Id. : " + Record.ProcTag + " - " + Record.ContractId + " - " + Record.ContractTitle);



		$("#form_mandatory_prep .wajib").val("");
		$("#form_mandatory_prep .select2").val("").trigger('change');
		$("#ProcessCatatan").val("");
		$("#ProcessCatatan").val("");
		$('#ENeedCorrection,#EUpdateDraft').prop('checked', false); // Checks it

	
		$("#main_panel").hide("fade", function () {

			//$(".group_drafting,.group_drafting_2").hide();
			$(".outer_page_drafting_v2").html("");
			$("#template_e_contract").show("fade", function () {

				render_draft_info();
				

			});

		})


	}


	function ViewLogContract() {
		form_contract_detail("EDIT", current_contract, null, "Log");
		w2ui['gridHistory'].refresh();
	}

	function upload_draft_manual() {

		$("#manual_draft_upload_panel").show();
		$("#ModalUploadDraftManual .alert-danger").hide();
		$("#manual_draft_upload_process").hide();
		$("#ModalUploadDraftManual .modal-footer").show();

		var file_input = $('#file_draft_manual');
		file_input.ace_file_input('reset_input');

		$('#ModalUploadDraftManual').modal(
			{
				backdrop: 'static',
				keyboard: false
			}
		);
		$("#ModalUploadDraftManual").modal("show");
	}


	function upload_draft_manual_push() {

		var file_draft = $("#file_draft_manual").get(0).files;
		if (file_draft.length == 0) {

			$("#ModalUploadDraftManual .alert-danger .pesan_error").html("harap sertakan file draft !");
			$("#ModalUploadDraftManual .alert-danger").show();

			return;
		}

		$("#manual_draft_upload_panel").hide();
		$("#ModalUploadDraftManual .modal-footer").hide();
		//modal-footer
		$("#manual_draft_upload_process").show("fade", function () {

			var DataSave = new FormData();
			DataSave.append('ContractId', current_contract.ContractId);
			DataSave.append('MAIN_DRAFT', file_draft[0]);

			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/UploadDraftEContractManual',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {

					$("#manual_draft_upload_process").hide();
					$("#manual_draft_upload_panel").show();
					$("#ModalUploadDraftManual .alert-danger .pesan_error").html("Error, try again or contact our administrator please !");
					$("#ModalUploadDraftManual .alert-danger").show();
					$("#ModalUploadDraftManual .modal-footer").show();

				}
			});

			if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
				$("#manual_draft_upload_process").hide();
				$("#manual_draft_upload_panel").show();
				$("#ModalUploadDraftManual .alert-danger .pesan_error").html(Simpan.responseJSON["Result"]);
				$("#ModalUploadDraftManual .alert-danger").show();
				$("#ModalUploadDraftManual .modal-footer").show();
			}
			else {
				
				$("#ModalUploadDraftManual").modal("hide");
				w2alert("Upload draft success !");
				render_draft_info()

			}
			
		});


	}

	function generate_old_draft() {


		var Param_ = new FormData();
		Param_.append('ContractId', current_contract.ContractId);

		$("#template_e_contract").hide();
		$("#progress_save_draft").show("fade", function () {

			var _process = $.ajax({
				url: URL_PTPR + '/EContract/ConvertOldDarft',
				type: 'POST',
				data: Param_,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
			});


			if (_process.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {

				w2alert(_process.responseJSON["Result"]);
				$("#progress_save_draft").hide();
				$("#template_e_contract").show();

			}
			else {

				w2alert("Generate Old Draft Success");
				$("#progress_save_draft").hide();
				$("#template_e_contract").show();
				render_draft_info();

			}

		})

		
	}

	function render_draft_info() {

		var DownloadDraft_1 = "";
		var DownloadDraft_2 = "";
		var result_wording = "";

		var Param_ = new FormData();
		Param_.append('ContractId', current_contract.ContractId);

		var get_last_file = $.ajax({
			url: URL_PTPR + '/EContract/GetLastDraftEContractProcurement',
			type: 'POST',
			data: Param_,
			dataType: "json",
			cache: false,
			async: false,
			contentType: false,
			processData: false,
		});

		if (get_last_file.responseJSON.length > 0) {

			DownloadDraft_1 = '<div class= "' + css_color + '" onclick="' + link_down + '(' + get_last_file.responseJSON[0].ID + ')" ondblclick="' + link_down + '(' + get_last_file.responseJSON[0].ID + ')"><i class="' + icon_download + '" aria-hidden="true"></i> <br><br>Download <br>File Kontrak Rangkap Ke 1</div> ';

			if (get_last_file.responseJSON.length > 1) {

				DownloadDraft_2 = '<div class= "' + css_color + '" onclick="' + link_down + '(' + get_last_file.responseJSON[1].ID + ')" ondblclick="' + link_down + '(' + get_last_file.responseJSON[1].ID + ')"><i class="' + icon_download + '" aria-hidden="true"></i> <br><br>Download <br>File Kontrak Rangkap Ke 2</div> ';
			}

			result_wording = '<div class="result_wording">Berikut ini adalah darft kontrak yang telah dibuat oleh user. <br> Silahkan download dan riview serta edit jika ada perubahan, kemudian Anda dapat me-reupload kembali jika dirasa perlu ! </div>';

		}
		else {
			var cek_allow_upload = $.ajax({
				url: URL_PTPR + '/Button/CekAllowUploadDraftEKontrak?Id=' + current_contract.ContractId,
				type: 'GET',
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
			});
			raw_ = cek_allow_upload.responseJSON[0];
			if (raw_.Allow == 1) {
				result_wording = '<div class="result_wording"> Draft tidak ditemukan harap upload draft contract kembali !</div>';
				result_wording = result_wording + '<br><br><button class="btn btn-primary btn-xlg" onclick="upload_draft_manual()"><i class="fa fa-cloud-upload" aria-hidden="true"></i> Click disini untuk upload !</button> ';
				result_wording = result_wording + '<button class="btn btn-warning btn-xlg" onclick="generate_old_draft()"><i class="fa fa-file" aria-hidden="true"></i> Generate Dari Draft Lama</button>';
			}
			else {
				result_wording = '<div class="result_wording"> Draft tidak ditemukan harap upload draft contract kembali, atau hubungi administrator atau user yang mengajukan e-kontrak ini untuk memperbaharui draft !</dvi>';
			}

		}


		$(".outer_page_drafting_v2").html('<div class="page"><div class="group_file_kontrak">' + result_wording + DownloadDraft_1 + DownloadDraft_2 + '</div></div>');
				//full_screen('#template_e_contract');
	}

</script>

@*//Drafting Tools JS*@
<script>



	function add_new_page(page_header) {

		const now = new Date();
		const offsetMs = now.getTimezoneOffset() * 60 * 1000;
		const dateLocal = new Date(now.getTime() - offsetMs);
		var page_id = dateLocal.toISOString().slice(0, 19).replace(/-/g, "-").replace("T", "-").replace(":", "-").replace(":", "-").replace("/", "-").replace(" ", "-");;

		var curret_ = 'editor' + page_id;

		var page_header = '<div class="input_box_draft input_header" id="header' + curret_ + '">Header</div>';
		var page_footer = '<div class="input_box_draft input_footer" id="footer' + curret_ + '">' + page_ + '</div>';;
		var new_page = '<div class="page" id="' + page_id + '-' + page_ + '"><div class="page_header">' + page_header + '</div><div class="content_editor" id="' + curret_ + '"></div><div class="page_footer">New Page #' + page_footer + '</div></div>';

		$(".outer_page_drafting_v2").append(new_page);


		var ck_edit_obj = page_id + '-' + page_;

		var introduction = document.getElementById(curret_);
		introduction.setAttribute('contenteditable', true);

		CKEDITOR.inline(curret_, {
			// Allow some non-standard markup that we used in the introduction.
			extraAllowedContent: 'a(documentation);abbr[title];code',
			removePlugins: 'stylescombo',
			removeButtons: 'PasteFromWord',
			editorplaceholder: 'Start typing here...',
			// Show toolbar on startup (optional).
			startupFocus: false
		});


		var introduction2 = document.getElementById('header' + curret_);
		introduction2.setAttribute('contenteditable', true);

		CKEDITOR.inline('header' + curret_, {
			// Allow some non-standard markup that we used in the introduction.
			extraAllowedContent: 'a(documentation);abbr[title];code',
			removePlugins: 'stylescombo',
			removeButtons: 'PasteFromWord',
			// Show toolbar on startup (optional).
			startupFocus: false
		});



		var introduction3 = document.getElementById('footer' + curret_);
		introduction3.setAttribute('contenteditable', true);

		CKEDITOR.inline('footer' + curret_, {
			// Allow some non-standard markup that we used in the introduction.
			extraAllowedContent: 'a(documentation);abbr[title];code',
			removePlugins: 'stylescombo',
			removeButtons: 'PasteFromWord',
			// Show toolbar on startup (optional).
			startupFocus: false
		});

		page_ = page_ + 1;
		$("#" + curret_).focus();

	}

	function close_drafting() {

		$("#template_e_contract").hide("fade", function () {
			$("#main_panel").show();
			$(".main-content-inner .breadcrumb .active").html("General");
			if (w2ui['gridContract'] != null) { refresh_contract_list(); }
			UpdateCountProgress();
		});

	}


	function delete_page() {

		var last_page = "";
		var count_page = 0;

		$(".page").each(function () {
			var element = $(this);
			last_page = element[0].id;
			count_page = count_page + 1;
		});

		if (count_page > 1) {

			$("#" + last_page).remove();
			page_ = page_ - 1;
		}
		else {
			w2alert("Oops... You cannot delete last page !");
		}


	}


</script>

@*//Drafting Attachment Add*@
<script>

	var oFileTotal = [];
	var oFileCount = 0;

	$('#attachment_draft_e_kontrak').change(function () {

		const oFile = document.getElementById("attachment_draft_e_kontrak").files;

		for (var i = 0; i < oFile.length; i++) {
			oFileCount = oFileCount + 1
		}

	
		oFileTotal.push(oFile);

		if (oFileTotal.length > 0) {

			$(".btn-clear-attach").show();
			$(".btn-attach-info").html('<i class="ace-icon fa fa-list" aria-hidden="true"></i> ' + oFileCount + ' File Attach');
		}
		else {

			$(".btn-clear-attach").hide();
		}

	});


	function clear_attach_file() {

		$(".btn-clear-attach").hide();
		oFileTotal = [];
		oFileCount = 0;
		var file_input = $('#attachment_draft_e_kontrak');
		file_input.ace_file_input('reset_input');
	}


</script>


@*daftar_lampiran_js*@
<script>

	function lihat_attachment() {


		if (w2ui['gridLampiran'] != null) { w2ui['gridLampiran'].destroy(); }

		$('#ModalListAttacment').on('shown.bs.modal', function () {

			$('#gridLampiran').w2grid({

				name: 'gridLampiran',
				url: URL_PTPR + '/EContract/GetEContractGeneralFile?ContractId=' + current_contract_id,
				show: {
					header: false,
					footer: true,
					lineNumbers: true,
					toolbarAdd: false,
					toolbarDelete: false,
					toolbar: true,
					toolbarSearch: false,
				},
				toolbar: {
					items: [
						//{ type: 'button', id: 'view_attachment', caption: '<i class="fa fa-folder-open" aria-hidden="true" style="color:orange;"></i> View Attachment Beside of Draft', disabled: true },
						//{ type: 'break' },
						{ type: 'button', id: 'view_in_new_tab', caption: '<i class="fa fa-external-link" aria-hidden="true" style="color:green;"></i> View In New Tab', disabled: true },
					],
					onClick: function (target, data) {

						switch (target) {
							case 'view_attachment':
								var sel = w2ui.gridLampiran.getSelection();
								var record = w2ui.gridLampiran.get(sel[0]);
								view_attachment(record);
								break;
							case 'view_in_new_tab':
								var sel = w2ui.gridLampiran.getSelection();
								var record = w2ui.gridLampiran.get(sel[0]);
								var file_url = "";
								if (record.API == "DocMan") {
									file_url = URL_PTPR + "/EContract/ViewAttachment?Id=" + record.ID;
								}
								else {
									file_url = URL_PTPR + '/File_Contract/' + record.FileName_org;
								}

								window.open(file_url, '_blank');
								break;

						}

					}
				},
				columns: [

					{ field: 'DocType', caption: 'Tipe Dokumen', size: '200px', searchable: 'text' },
					{ field: 'FileName', caption: 'File Name', size: '100%', searchable: 'text' }

				],
				onDblClick: function (event) {
					var record = this.get(event.recid);
					var file_url = "";
					if (record.API == "DocMan") {
						file_url = URL_PTPR + "/EContract/ViewAttachment?Id=" + record.ID;
					}
					else {
						file_url = URL_PTPR + '/File_Contract/' + record.FileName_org;
					}

					window.open(file_url, '_blank');


				},
				onSelect: function (event) {

					event.onComplete = function () {
						var contract = w2ui.gridLampiran.getSelection();
						//w2ui['gridLampiran'].toolbar.disable('view_attachment');
						w2ui['gridLampiran'].toolbar.disable('view_in_new_tab');

						if (contract.length == 1) {

							var record = this.get(event.recid);
							//w2ui['gridLampiran'].toolbar.enable('view_attachment');
							w2ui['gridLampiran'].toolbar.enable('view_in_new_tab');

						}
					}

				},
				onUnselect: function (event) {

					event.onComplete = function () {
						var contract = w2ui.gridLampiran.getSelection();
						//w2ui['gridLampiran'].toolbar.disable('view_attachment');
						w2ui['gridLampiran'].toolbar.disable('view_in_new_tab');

						if (contract.length == 1) {

							var record = this.get(event.recid);
							//w2ui['gridLampiran'].toolbar.enable('view_attachment');
							w2ui['gridLampiran'].toolbar.enable('view_in_new_tab');

						}
					}
				}


			});
		})


		$('#ModalListAttacment').modal(
			{
				backdrop: 'static',
				keyboard: false
			}
		);



	}

	function view_attachment(record) {


		$("#template_e_contract").find(".preview_attachment").remove();
		var tinggi = 0;



		var box_;
		var file_url = URL_PTPR + "/EContract/ViewAttachment?Id=" + record.ID;


		if (record.API == 'DocMan') {

			file_url = URL_PTPR + "/EContract/ViewAttachment?Id=" + record.ID;
		}
		else {

			file_url = URL_PTPR + '/File_Contract/' + record.FileName_org;
		}

		if (open_preview == 0) {

			$(".outer_page_drafting_v2").addClass("bagi_dua");
			open_preview = 1;
		}


		if (full_screen_stat == 1) {

			tinggi = Number(window.innerHeight) - 50;
		}
		else {

			tinggi = Number(window.innerHeight) - 169;
		}

		box_ = '<div class="preview_attachment bagi_dua">';
		box_ = box_ + '<div class="judul_preview_file"><table id="title_prev" width="100%"><tr><td width="80%">' + record.FileName + '</td>';
		box_ = box_ + '<td width="10%" style="text-align:right;"><span onclick="close_preview_attachment()" class="close_prev_"> <i class="fa fa-times-circle-o" aria-hidden="true"></i> Close</span></td></tr></table></div>';
		box_ = box_ + '<iframe src="' + file_url + '" scrolling="no" id="frame_preview" class="frame_prev" frameborder="1" style="width:100%;border:1px;height:' + tinggi + 'px;"></iframe></div>';


		$(".outer_page_drafting_v2 ").after(box_);
		$('.preview_attachment').css('height', tinggi);
		$('#ModalListAttacment').modal("hide");



	}

	function close_preview_attachment() {

		$("#frame_preview").attr("src", "");
		$(".preview_attachment").hide();
		$(".outer_page_drafting_v2").removeClass("bagi_dua");
		open_preview = 0;
	}



	function download_draft_v2(Id) {

		var param = { 'Id': Id, };
		OpenWindowWithPost(URL_PTPR + '/EContract/GetDraftDoc', "width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes",
			"ContractId", param);


	}

	function download_draft_sign(Id) {

		var param = { 'Id': Id, };
		OpenWindowWithPost(URL_PTPR + '/EContract/ViewFile', "width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes",
			"ContractId", param);


	}

</script>

@*process*@
<script>


	function download_draft(X) {


		if (X == undefined) {

			$('#ModalDownloadDraft').modal(
				{
					backdrop: 'static',
					keyboard: false
				}
			);
		}
		else {

			RptHTML = $(".outer_page_drafting_v2").html();
			var param = { 'ContractId': current_contract_id, 'RptHTML': '-', 'Rangkap': X };
			OpenWindowWithPost(URL_PTPR + '/EContract/PrintEKontrakProcurement', "width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes",
				"ContractId", param);

			$('#ModalDownloadDraft').modal("hide");
		}

	}

	function back_to_drafting() {

		current_reject = 0;
		$("#proses_next_step").hide("fade", function () {

			//$(".main-content-inner .breadcrumb .active").html("General");
			$("#template_e_contract").show();

		})
	}

	function cancel_add() {

		current_reject = 0;
		$("#add_new_draft_panel").hide("fade", function () {

			$("#main_panel").show();

		})
	}

	function add_draft(flagops) {

		current_process = flagops;

		$('#add_new_draft_panel #ENeedCorrection,#add_new_draft_panel #EUpdateDraft').prop('checked', false); // Checks it
		$("#add_new_draft_panel #pre_reject_wording,#add_new_draft_panel #pre_process_wording").hide();
		$("#add_new_draft_panel .cek_box").show();

		$("#add_new_draft_panel #form_mandatory_prep .wajib").val("");
		$("#add_new_draft_panel #form_mandatory_prep .select2").val("").trigger('change');

		$("#pre_process_wording").show();
		$("#add_new_draft_panel .file_sign_upload_group").show();
		var file_input = $('#add_new_draft_panel #file_draft');
		file_input.ace_file_input('reset_input');
		clear_attach_file();
		$("#main_panel").hide("fade", function () {
			$("#add_new_draft_panel").show();
			$("#EContractTitle").focus();
			render_gridMail_add();
		})


	}


	function prep_save_draft(flagops) {

		//arif
		

		$('#proses_next_step #ENeedCorrection,#proses_next_step #EUpdateDraft,#proses_next_step #EUnprocedural').prop('checked', false); // Checks it
		$("#proses_next_step #pre_reject_wording,#proses_next_step #pre_process_wording").hide();
		$("#proses_next_step .cek_box").show();
		$("#field_unprocedural").hide();

		if (flagops == "reject") {

			$("#proses_next_step #pre_reject_wording").show();
			$("#proses_next_step .file_sign_upload_group,#proses_next_step #field_lanjut_dengan_catatan").hide();
			$("#field_unprocedural").show();
			$("#template_e_contract").hide("fade", function () {

				$("#next_step_wording").html("Anda Akan Mareject Draft Ini  : ");
				$("#proses_next_step").show();

			})

			current_reject = 1;
		}
		else {

			if (current_contract.InProcess == 4 || current_contract.InProcess == 5) {

				$("#proses_next_step #pre_process_wording").show();
				$("#proses_next_step .file_sign_upload_group").show();
				$("#proses_next_step .cek_box").hide();
				if (current_contract.InProcess == 1) { $("#proses_next_step #field_lanjut_dengan_catatan").show(); } else { $("#proses_next_step #field_lanjut_dengan_catatan").hide(); }


			}
			else {

				$("#proses_next_step #pre_process_wording").show();
				$("#proses_next_step .file_sign_upload_group").hide();
				if (current_contract.InProcess == 1) { $("#proses_next_step #field_lanjut_dengan_catatan").show(); } else { $("#proses_next_step #field_lanjut_dengan_catatan").hide(); }
				if (current_contract.InProcess == 3) $("#proses_next_step .cek_box").hide();

			}


			if (current_contract.InProcess == 1 || current_contract.InProcess == 3 || current_contract.InProcess == 0) {
				$("#proses_next_step #field_update_draft").show();
			}
			else {
				$("#proses_next_step #field_update_draft").hide();
			}


			$("#template_e_contract").hide("fade", function () {

				$("#proses_next_step #next_step_wording").html("Proses Selanjutnya : " + current_contract.NextProcessTag);
				$("#proses_next_step").show();

			})

		}


	}

	function back_from_isi_email() {

		$("#proses_next_step_mail").hide("fade", function () {

			//$(".main-content-inner .breadcrumb .active").html("General");
			$("#add_new_draft_panel").show();

		})
	}

	function isi_email_alert() {


		var last_empty_id = "";
		var xcount = 1;
		var validate_save = true;
		var json_field = [];


		var file_draft = $("#add_new_draft_panel #file_draft").get(0).files;
		if (file_draft.length == 0) {

		w2alert("Harap sertakan draft kontrak !");
		return;
		}


		$("#form_mandatory_prep .wajib").each(function () {
		var element = $(this);
		if (element.val() == "") {

		isValid = false;
		var fill_placeholder = element[0].attributes["placeholder"];
		var placeHolderText = fill_placeholder.nodeValue;
		placeHolderText = placeHolderText.replace("Harap diisi", "").trim().replace("[ Wajib diisi ! ]", "").trim();
		$("#" + element[0].id).attr("placeholder", placeHolderText + " [ Wajib diisi ! ]");
		if (xcount == 1) last_empty_id = element[0].id;

		xcount = xcount + 1;
		validate_save = false;

		}
		});


		if (validate_save == false) {

		$("#" + last_empty_id).focus();
		return;
		}


		$("#add_new_draft_panel").hide("fade", function () {
			$("#proses_next_step_mail").show();
			w2ui['gridMail_add'].refresh();
		})



	}

	function render_gridMail_add() {

		if (w2ui['gridMail_add'] != null) {
			w2ui['gridMail_add'].destroy();
		}


		TempDelete = [];

		$('#gridMail_add').w2grid({
			name: 'gridMail_add',
			show: {
				header: false,
				footer: true,
				lineNumbers: true,
				toolbarAdd: false,
				toolbarDelete: true,
				toolbar: true,
				toolbarSearch: false,
			},
			columns: [

				{ field: 'Email', caption: 'Mail Destination', size: '200px', searchable: 'text', editable: { type: 'text' } },
				{ field: 'Name', caption: 'Name', size: '200px', searchable: 'text', editable: { type: 'text' } },
				{ field: 'Jabatan', caption: 'Jabatan', size: '200px', searchable: 'text', editable: { type: 'text' } },
			],
			toolbar: {
				items: [
					{ id: 'add', type: 'button', caption: 'Add Mail', icon: 'w2ui-icon-plus' }
				],
				onClick: function (event) {
					if (event.target == 'add') {
						input_mail_grid();
					}
				}
			},


		});

	}

	function input_mail_grid() {

		$("#penerima_email").val("");
		$("#alamat_email").val("");
		$("#jabatan_penerima").val("");

		button = '<button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Cancel</button>';
		button = button + '<button type="button" class="btn btn-info btn-sm" onclick="add_mail(\'ADD\')">Add</button>';

		$("#ModalInputMail .modal-footer").html(button);
		$("#ModalInputMail").modal({ backdrop: 'static', keyboard: false });
		$("#ModalInputMail").on('shown.bs.modal', function (e) {
			$("#penerima_email").focus();
		});
	}

	function add_mail() {

		var flag = "ADD";
		var isValid = true;

		$("#ModalInputMail .wajib_diisi").each(function () {

			var element = $(this);

			if (element.val() == "") {

				isValid = false;
				var fill_placeholder = element[0].attributes["placeholder"];
				var placeHolderText = fill_placeholder.nodeValue;
				placeHolderText = placeHolderText.replace("Wajib Diisi", "").trim() + " Wajib Diisi";

				$("#" + element[0].id).attr("placeholder", placeHolderText);

			}

		});

		if (isValid == true) {


			w2ui.gridMail_add.save();


			if (flag == 'ADD') {


				var list_Rec = w2ui['gridMail_add'].records;
				var new_rec = new Array();

				if (list_Rec.length > 0) {

					for (x = 0; x < list_Rec.length; x++) {

						new_rec.push(list_Rec[x].recid);

					}

					var new_recid = Math.max.apply(Math, new_rec);
					w2ui['gridMail_add'].add({
						recid: new_recid + 1
						, Email: $('#alamat_email').val()
						, Name: $('#penerima_email').val()
						, Jabatan: $('#jabatan_penerima').val()
					

					});

				}
				else {

					w2ui['gridMail_add'].add({
						recid: 1
						, Email: $('#alamat_email').val()
						, Name: $('#penerima_email').val()
						, Jabatan: $('#jabatan_penerima').val()

					});

				}


			}
			else {
				w2ui['gridMail_add'].set(IdSelect, { Email: $('#alamat_email').val(), Name: $('#penerima_email').val(), Jabatan: $('#jabatan_penerima').val() });
			}


	
			$("#ModalInputMail").modal("hide");

		}
	}




	function submit_draft() {

		var last_empty_id = "";
		var xcount = 1;
		var validate_save = true;
		var json_field = [];

		var CaptureDiv = $(".outer_page_drafting_v2").html();
		var ProcessCatatan = $("#ProcessCatatan").val();
		var NeedCorrection = $("#ENeedCorrection").is(':checked');
		var UpdateDraft = $("#EUpdateDraft").is(':checked');
		var UnProcedural = $("#EUnprocedural").is(':checked');
		var file_sign_1= $('#ProcessUpload_1').get(0).files;;
		var file_sign_2 = $('#ProcessUpload_2').get(0).files;;
		

		if (current_process == "ADD") {

			var file_draft = $("#add_new_draft_panel #file_draft").get(0).files;
			w2ui['gridMail_add'].save();
			var ListDest = w2ui['gridMail_add'].records;
			ProcessCatatan = $("#add_new_draft_panel #Remark").val();
			

			if (ListDest.length < 3 ) {
				w2alert("Harap sertakan minimal 3 email alert !");
				return;
			}
		
			if (file_draft.length == 0) {

				w2alert("Harap sertakan draft kontrak !");
				return;
			}


			$("#form_mandatory_prep .wajib").each(function () {
				var element = $(this);
				if (element.val() == "") {

					isValid = false;
					var fill_placeholder = element[0].attributes["placeholder"];
					var placeHolderText = fill_placeholder.nodeValue;
					placeHolderText = placeHolderText.replace("Harap diisi", "").trim().replace("[ Wajib diisi ! ]", "").trim();
					$("#" + element[0].id).attr("placeholder", placeHolderText + " [ Wajib diisi ! ]");
					if (xcount == 1) last_empty_id = element[0].id;

					xcount = xcount + 1;
					validate_save = false;

				}
			});


			if (validate_save == false) {

				$("#" + last_empty_id).focus();
				return;
			}

			

		}


		$("#proses_next_step_mail").hide();
		$("#proses_next_step").hide();

		$("#progress_save_draft").show("fade", function () {

			var DataSave = new FormData();
				//DataSave.append('ProcId', current_contract.ProcurementId);
			DataSave.append('FormField', "");
				/*DataSave.append('FormCapture', CaptureDiv)*/;
			DataSave.append('FormCaptureEdit', "");
			DataSave.append('ContractId', current_contract.ContractId);
			DataSave.append('ContractType', "");
			DataSave.append('PenanggungJawabPihak1', $("#EPerson").val());
			DataSave.append('ContractTitle', $("#EContractTitle").val());
			DataSave.append('ContractValue', $("#Etemp_ContractValue").val()); //Etemp_ContractValue
			DataSave.append('StartDate', $("#add_new_draft_panel #EStartDate").val());
			DataSave.append('EndDate', $("#add_new_draft_panel #EEndDate").val());
			DataSave.append('FlagCrud', current_process);
			DataSave.append('FormId', 0);
			DataSave.append('NeedCorrection', Number(NeedCorrection));
			DataSave.append('UnProcedural', Number(UnProcedural));
			DataSave.append('UpdateDraft', Number(UpdateDraft));
			DataSave.append('Remark', ProcessCatatan);
			DataSave.append('IsReject', current_reject);
			DataSave.append('Fungsi', $("#EFungsi").val());
			

			if (current_process == "ADD") {

				var file_draft = $("#add_new_draft_panel #file_draft").get(0).files;
				if (file_draft.length > 0) {

					DataSave.append('MAIN_DRAFT', file_draft[0]);
				}

				if (ListDest.length > 0) {

					var ListDest_ = JSON.stringify(ListDest);
					DataSave.append('MailDestinations', ListDest_);
				}
			}
			else {

				var file_draft = $("#proses_next_step #file_draft").get(0).files;

				if (file_draft.length > 0) {

					DataSave.append('MAIN_DRAFT', file_draft[0]);
				}

				if (file_sign_1.length > 0) {

					DataSave.append('MAIN_DRAFT', file_sign_1[0]);
				}


				if (file_sign_2.length > 0) {

					DataSave.append('MAIN_DRAFT', file_sign_2[0]);
				}

			}


			var count_lampiran = 0;
			for (var i = 0; i < oFileTotal.length; i++) {

				var uploader_attachment = oFileTotal[i];

				for (var x = 0; x < uploader_attachment.length; x++) {

					count_lampiran = Number(i) + 1;

					DataSave.append("Lampiran_" + count_lampiran, uploader_attachment[x]);
				}
				
			}


			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/SaveEContractGeneral',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {

					if (current_process == "ADD") {
						//add_new_draft_panel
						$("#progress_save_draft").hide();
						$("#proses_next_step_mail").show();
					}
					else {
						$("#progress_save_draft").hide();
						$("#proses_next_step").show();
					}

					w2alert("Error, try again or contact our administrator please !", "Process E-Kontrak");

				}
			});


			if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {

				if (current_process == "ADD") {
					//add_new_draft_panel
					$("#progress_save_draft").hide();
					$("#proses_next_step_mail").show();
				}
				else {
					$("#progress_save_draft").hide();
					$("#proses_next_step").show();
				}


				w2alert(Simpan.responseJSON["Result"]);

			}
			else {
				if (current_reject == 1 || NeedCorrection == true) {

					if (current_reject == 1) w2alert("Proses Reject E-Kontrak berhasil.", "Process E-Kontrak");
					if (NeedCorrection == true) w2alert("Proses Lanjut Dengan Catatan E-Kontrak berhasil.", "Process E-Kontrak");
				}
				else {
					w2alert("Proses berhasil.", "Process E-Kontrak");
				}

				$("#proses_next_step").hide();
				$("#progress_save_draft").hide();
				$("#add_new_draft_panel").hide();
				$("#proses_next_step_mail").hide();
				$("#main_panel").show();
				$(".main-content-inner .breadcrumb .active").html("E-Contract General");
				UpdateCountProgress();
				refresh_contract_list();
			}


		});


	}

</script>

@*other*@
<script>
	$('.uploader').ace_file_input({
		btn_choose: 'Browse',
		btn_change: null,
		no_icon: 'ace-icon fa fa-cloud-upload',
		droppable: true,
		thumbnail: 'small',
		no_file: '',
	}).on('change', function () {



	});

	function format_currency(Field_ID, temp_field) {

		if ($("#" + Field_ID).val() != "") {

			var Nominal = $("#" + Field_ID).val();
			Nominal = Nominal.replace(/,/g, "");
			$("#" + temp_field).val(Nominal);
			var fix_num = numberWithCommas(Nominal);

			$("#" + Field_ID).val(fix_num);

		}
		else {

			$("#" + temp_field).val("");

		}

	}

	$('#EStartDate,#EEndDate').w2field('date', { format: 'yyyy/mm/dd' });
	$(document).ready(function () {
		$("#add_new_draft_panel #EContractValue").keydown(function (e) {
			// Allow: backspace, delete, tab, escape, enter and .
			if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
				// Allow: Ctrl+A,Ctrl+C,Ctrl+V, Command+A
				((e.keyCode == 65 || e.keyCode == 86 || e.keyCode == 67) && (e.ctrlKey === true || e.metaKey === true)) ||
				// Allow: home, end, left, right, down, up
				(e.keyCode >= 35 && e.keyCode <= 40)) {
				// let it happen, don't do anything
				return;
			}
			// Ensure that it is a number and stop the keypress
			if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
				e.preventDefault();
			}
		});
	});

</script>

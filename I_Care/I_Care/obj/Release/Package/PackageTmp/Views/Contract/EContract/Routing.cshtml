@{
	Layout = null;
}
<script>
	//flagRouting = "NEXT"; current_contract = [];
</script>

<style>

	#proses_next_step {
		margin: 2% auto;
		padding: 5%;
		padding-top: 0%;
		padding-bottom: 0%;
		margin-top: 1%;
		margin-bottom: 0%;
		border: 0px solid #dedede;
		width: 80%;
	}

	#proses_next_step .control-label {
		font-size: 12px;
		padding-top: 0px !important; 
		text-align:left;
	}

	.form-control {
		text-align:left !important;
	}

	.form_header, .form_footer {
		text-align:center;
		
	}
	.form_footer {
		margin-top: 10px;
		border-top: 1px dashed #dedede;
		padding-top: 10px;
		margin-bottom:10px;
	}
	.icon_process {
		font-size: 25px;
		margin-bottom: 10px;
		font-weight: bold;
	}
	.header_wording {
		font-size: 14px;
		font-weight: normal;
	}

	/*@@media screen and (max-width: 992px) {

		.form_header {
			text-align: left;
		}
		.icon_process {
			font-size: 16px;
			font-weight: normal;
		}

		.header_wording {
			font-size: 12px;
			font-weight: normal;
		}
	
	}*/

	@@media screen and (max-width: 600px) {
		#proses_next_step {
			margin: 1% auto;
			padding: 2%;
			width: 90%;
		}

		.form_header {
			text-align: justify;
		}
		.icon_process {
			font-size: 18px;
			text-align:center;
			width:100%;
		}

		.header_wording {
			font-size: 12px;
			font-weight: normal;
		}
	}
</style>

<div id="proses_next_step" class="row">

	<div class="row form_header" style="margin-bottom:15px;border-bottom:1px dashed #dedede;padding-bottom:10px;" id="next_process_header" hidden>
		<div class="icon_process" id="icon_process"><i class="fa fa-search" style="color:orange;"></i> Proses Review Oleh Legal</div>
		<span class="header_wording">
			Pastikan <b>DRAFT E-KONTRAK</b> yang akan Anda proses ini telah sesuai. <br />
			Atau Anda dapat memerikasa-nya kembali dan Anda juga dapat meninggkalkan catatan 
			dan memperbaharui draft kontrak Anda pada proses ini.
		</span>
		<br />
	</div>

	<div class="row form_header" style="margin-bottom:15px;border-bottom:1px dashed #dedede;padding-bottom:10px;" id="reject_process_header" hidden>
		<div class="icon_process"><i class="fa fa-reply" style="color:#ff0000;"></i> Reject This Contract</div>
		<span class="header_wording">
			Yakin mau mereject <b>DRAFT E-KONTRAK</b> ini ?<br />
			Atau Anda dapat memerikasa-nya kembali dan Anda juga
			dapat meninggkalkan catatan pada proses ini.
		</span>
		<br />
	</div>


	<div class="row form_mandatory">
		<form class="form-horizontal">
			<div class="box-body">



				<div class="form-group">
					<label for="inputName" class="col-sm-4 control-label">Contract Id.</label>
					<div class="col-sm-8">
						<span id="snap_ContractId" style="font-weight:bold;" class="form-control"></span>
					</div>
				</div>


				<div class="form-group">
					<label for="inputName" class="col-sm-4 control-label">Judul</label>
					<div class="col-sm-8" >
						<span id="snap_ContractTitle" class="form-control" style=" white-space: nowrap; overflow: hidden;text-overflow: ellipsis;" ></span>
					</div>
				</div>


				<div class="form-group">
					<label for="inputName" class="col-sm-4 control-label">Status Terakhir</label>
					<div class="col-sm-8">
						<span id="snap_ProcTag" class="form-control"></span>
					</div>
				</div>



				<div class="form-group" id="field_update_draft">
					<label for="inputName" class="col-sm-4 control-label">Perbaharui Draft</label>
					<div class="col-sm-8">
						<input type="file" id="draft_contract_file" required accept=".doc,.docx,.pdf" class="uploader form-control" />
					</div>
				</div>

				<div class="form-group cek_box" id="field_lanjut_dengan_catatan">
					<label for="inputName" class="col-sm-4 control-label mandatory">Lanjut Proses Dengan Catatan</label>
					<div class="col-sm-8" style="text-align:left !important;">
						<label class="block">
							<input name="form-field-checkbox" id="ENeedCorrection" type="checkbox" class="ace input-lg">
							<span class="lbl" style="color:#808080;font-size:12px;font-style:normal;"> Dengan menchecklist ini proses akan dilanjutkan dengan catatan dan akan dikembalikan ke pembuat draft.</span>
						</label>
					</div>
				</div>


				<div class="form-group cek_box" id="field_unprocedural">
					<label for="inputName" class="col-sm-4 control-label mandatory">Tidak Sesuai Prosedur</label>
					<div class="col-sm-8" style="text-align:left !important;">
						<label class="block">
							<input name="form-field-checkbox" id="EUnProcedural" type="checkbox" class="ace input-lg">
							<span class="lbl" style="color:#808080;font-size:12px;font-style:normal;"> Dengan menchecklist ini proses kontrak dianggap tidak sesuai prosedur dan akan langsung dimasukan ke list trash.</span>
						</label>
					</div>
				</div>

				<div class="form-group signed_draft wajib_upload">
					<label for="inputName" class="col-sm-4 control-label mandatory">Upload Signed Draft I <mandatory>*</mandatory></label>
					<div class="col-sm-8">
						<input type="file" id="draft_signed_1" required accept=".doc,.docx,.pdf" class="uploader form-control" />
					</div>
				</div>
				<div class="form-group signed_draft">

					<label for="inputName" class="col-sm-4 control-label mandatory">Upload Signed Draft II <mandatory>*</mandatory></label>
					<div class="col-sm-8">
						<input type="file" id="draft_signed_2" required accept=".doc,.docx,.pdf" class="uploader form-control" />
					</div>
				</div>

				<div class="form-group sign_para_pihak_mandatory">
					<label for="inputName" class="col-sm-4 control-label mandatory">Tgl. Kontrak <mandatory>*</mandatory></label>
					<div class="col-sm-2">
						<input type="text" class="input-sm form-control  wajib" id="ETglKontrak" placeholder="Tgl. Kontrak" autocomplete="off">
					</div>

					<label for="inputName" class="col-sm-3 control-label" style="text-align:right;">No. Kontrak <mandatory>*</mandatory></label>
					<div class="col-sm-3">
						<input type="text" class="input-sm form-control wajib" id="ENoKontrak" placeholder="No. Kontrak" autocomplete="off">
					</div>
				</div>



				<div class="form-group">
					<label for="inputName" class="col-sm-4 control-label mandatory">Tinggalkan Catatan</label>
					<div class="col-sm-8">
						<textarea class="form-control" id="ProcessCatatan" placeholder="Tinggalkan catatan jika diperlukan" autocomplete="off" style="height:80px;resize:none;"></textarea>
					</div>
				</div>

			</div>
		</form>
	</div>


	<div class="row form_footer">
		<button type="button" class="btn btn-primary btn-sm" onclick="submit_draft()" id="btn-save"><i class="ace-icon  fa fa-paper-plane" aria-hidden="true"></i> Process</button>
		<button type="button" class="btn btn-danger btn-sm" onclick="reject_draft()" id="btn-reject"><i class="ace-icon  fa fa-reply" aria-hidden="true"></i> Reject</button>
		<button type="button" class="btn btn-gray btn-sm" onclick="back_detail_page()">Cancel</button>
	</div>

</div>


<script>

	set_sub_child_breadcrumb("");

	if (flagRouting == "NEXT") { set_sub_child_breadcrumb("Process Contract Draft"); }
	if (flagRouting == "REJECT") { set_sub_child_breadcrumb("Reject Draft"); }

	var Upload_File_Main_Draft = [];
	var Delete_File_Main_Draft = [];
	var Upload_File_Signed_1 = [];
	var Upload_File_Signed_2 = [];

	function routing_draft() {

		$("#snap_ContractId").html(current_contract.ContractId);
		$("#snap_ContractTitle").html(current_contract.ContractTitle);
		$("#snap_ProcTag").html(current_contract.ProcTag);
		$("#field_update_draft").hide();
		$(".signed_draft,.sign_para_pihak_mandatory").hide();
		$(".cek_box").hide();
		$("#btn-save,#btn-reject").hide();

		if (flagRouting == "NEXT") {

			$("#next_process_header").show();
			$("#btn-save").show();
			$(".cek_box").show();
			$("#field_update_draft").show();

			if (current_contract.InProcess == 0) {
				$("#icon_process").html('<i class="fa fa-paper-plane" aria-hidden="true" style="color:#358dcb;"></i> Resubmit Draft');
			}
			else {
				$("#icon_process").html(current_contract.ProcTag);
			}

			if (current_contract.InProcess == 3 || current_contract.InProcess == 4 || current_contract.InProcess == 5) {
				$(".signed_draft").show();
				$("#field_update_draft").hide();
				$(".cek_box").hide();
			}

			if (current_contract.InProcess == 4 ) {
				$(".sign_para_pihak_mandatory").show();
			}
			if (current_contract.InProcess == 5) {
				$(".signed_draft").hide();
			}
			if (current_contract.InProcess == 0) {
				$(".cek_box").hide();
			}

		}

		if (flagRouting == "REJECT") {
			$("#reject_process_header").show();
			$("#field_update_draft").show();
			$("#btn-reject").show();
		}

		$("#proses_next_step").show("fade");

	}

	function back_detail_page() {

		flagCrud = "VIEW";
		set_sub_child_breadcrumb("");
		load_page("#PageContainer", URL_PTPR + "/Contract/EContractDetail", function () { $('.select2').css('width', '100%').select2(); });
	}

	function submit_draft() {

		var ProcessCatatan = $("#ProcessCatatan").val();
		var NeedCorrection = $("#ENeedCorrection").is(':checked');
		var UnProcedural = $("#EUnProcedural").is(':checked');
		var list_upload = [];
		
		if (current_contract.InProcess == 3 || current_contract.InProcess == 4) {

			if (Upload_File_Signed_1.length == 0) {
				w2alert("Harap upload draft I yang telah ditanda tangani !");
				return;
			}

			if (Upload_File_Signed_2.length == 0) {
				w2alert("Harap upload draft II yang telah ditanda tangani !");
				return;
			}
		}

		if (current_contract.InProcess == 4) {

			if ($("#ETglKontrak").val() == "") {
				$("#ETglKontrak").focus();
				w2alert("Harap input tanggal kontrak !");
				return;
			}

			if ($("#ENoKontrak").val() == "") {
				$("#ENoKontrak").focus();
				w2alert("Harap input nomor kontrak !");
				return;
			}


		}

		if (current_contract.InProcess == 3 || current_contract.InProcess == 4) {
			var row_upload = { ID: Upload_File_Signed_1[0].ID };
			list_upload.push(row_upload);
			var row_upload_2 = { ID: Upload_File_Signed_2[0].ID };
			list_upload.push(row_upload_2);
		}

		if (Upload_File_Main_Draft.length > 0) {
			var row_upload_3 = { ID: Upload_File_Main_Draft[0].ID };
			list_upload.push(row_upload_3);
		}


		if (ListAttachment_For_Routing.length > 0) {

			for (var i = 0; i < ListAttachment_For_Routing.length; i++) {
				var obj = ListAttachment_For_Routing[i];
				if (obj["PreUpload"] == '1') {
					var row_upload_4 = { ID: obj["Id"] };
					list_upload.push(row_upload_4);
				}
			}
		}

	
		var DataSave = new FormData();
		DataSave.append('FlagRouting', flagRouting);
		DataSave.append('ContractId', current_contract.ContractId);
		DataSave.append('Remark', ProcessCatatan);
		DataSave.append('NeedCorrection', Number(NeedCorrection));
		DataSave.append('UnProcedural', Number(UnProcedural));
		DataSave.append('ContractNo', $("#ENoKontrak").val());
		DataSave.append('ContractDate', $("#ETglKontrak").val());
		DataSave.append('Snooze', current_contract_snooze);
		if (list_upload.length > 0) {DataSave.append('FileUploadList', JSON.stringify(list_upload));}
		else { DataSave.append('FileUploadList', ''); }
		DataSave.append("MailDestinations", JSON.stringify(List_Mail_Alert))

		$("#Saving_Load").show("fade", function () {
			var Simpan = $.ajax({
				url: URL_PTR + '/Contract/SaveRoutingEContract',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					w2alert("Error, try again or contact our administrator please !", "Saving Contract Archive");
					$('#Saving_Load').hide();
				}

			});

			if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
				$('#Saving_Load').hide();
				w2alert(Simpan.responseJSON["Result"]);
			}
			else {
				w2alert("Save data success !");
				$('#Saving_Load').hide();
				back_main_page();
			}
		});
		
	
	
	}

	function reject_draft() {

		var ProcessCatatan = $("#ProcessCatatan").val();
		var list_upload = [];

		//if (current_contract.InProcess == 3 || current_contract.InProcess == 4) {
		//	var row_upload = { ID: Upload_File_Signed_1[0].ID };
		//	list_upload.push(row_upload);
		//	var row_upload_2 = { ID: Upload_File_Signed_2[0].ID };
		//	list_upload.push(row_upload_2);
		//}

		if (Upload_File_Main_Draft.length > 0) {
			var row_upload_3 = { ID: Upload_File_Main_Draft[0].ID };
			list_upload.push(row_upload_3);
		}

		if (ListAttachment_For_Routing.length > 0) {

			for (var i = 0; i < ListAttachment_For_Routing.length; i++) {
				var obj = ListAttachment_For_Routing[i];
				if (obj["PreUpload"] == '1') {
					var row_upload_4 = { ID: obj["Id"] };
					list_upload.push(row_upload_4);
				}
			}
		}


		var DataSave = new FormData();
		DataSave.append('FlagRouting', flagRouting);
		DataSave.append('ContractId', current_contract.ContractId);
		DataSave.append('Remark', ProcessCatatan);
		DataSave.append('Snooze', current_contract_snooze);
		if (list_upload.length > 0) { DataSave.append('FileUploadList', JSON.stringify(list_upload)); }
		else { DataSave.append('FileUploadList', ''); }
		DataSave.append("MailDestinations", JSON.stringify(List_Mail_Alert))

		$("#Saving_Load").show("fade", function () {
			var Simpan = $.ajax({
				url: URL_PTR + '/Contract/RejectRoutingEContract',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					w2alert("Error, try again or contact our administrator please !", "Saving Contract Archive");
					$('#Saving_Load').hide();
				}

			});

			if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
				$('#Saving_Load').hide();
				w2alert(Simpan.responseJSON["Result"]);
			}
			else {
				w2alert("Contract Rejected");
				$('#Saving_Load').hide();
				back_main_page();
			}
		});



	}

	$('#draft_contract_file').ace_file_input({

		btn_choose: 'Browse',
		btn_change: null,
		no_icon: 'ace-icon fa fa-cloud-upload',
		droppable: true,
		thumbnail: '',
		no_file: 'Klik disini untuk reupload draft kontrak',
		before_remove: function () {

			Id = Upload_File_Main_Draft[0].ID;
			Delete_File_Main_Draft = [];
			var row_delete = { ID: Id };
			Delete_File_Main_Draft.push(row_delete);

			var DataSave = new FormData();
			DataSave.append('FileCategory', "MAIN_DRAFT");
			DataSave.append('FileUploadList', JSON.stringify(Delete_File_Main_Draft));

			$("#Deleting_Load").show("fade", function () {

				var Simpan = $.ajax({
					url: URL_PTPR + '/EContract/DeleteFilePre',
					type: 'POST',
					data: DataSave,
					dataType: "json",
					cache: false,
					async: false,
					contentType: false,
					processData: false,
					error: function (request, status, error) {
						$("#Deleting_Load").hide();
						w2alert("Upload File Gagal !");
					}

				});

				if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
					$("#Deleting_Load").hide();
					w2alert("Upload File Gagal !");
					return false;
				}
				else {
					$("#Deleting_Load").hide();
					Upload_File_Main_Draft = [];
					w2alert("Draft Berhasil Dihapus!");
					var file_input = $('#draft_contract_file');
					file_input.ace_file_input('reset_input');
					return true;

				}
			})
		},
		preview_error: function (filename, error_code) {
		}
	}).on('change', function () {

		if (Upload_File_Main_Draft.length > 0) {

			Id = Upload_File_Main_Draft[0].ID;
			Delete_File_Main_Draft = [];
			var row_delete = { ID: Id };
			Delete_File_Main_Draft.push(row_delete);
			var DataSave = new FormData();
			DataSave.append('FileCategory', "MAIN_DRAFT");
			DataSave.append('FileUploadList', JSON.stringify(Delete_File_Main_Draft));

			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/DeleteFilePre',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					//$("#Deleting_Load").hide();
					//w2alert("Upload File Gagal !");
				}
			});
		}

		Upload_File_Main_Draft = [];
		var file = this.files[0];
		var file_name = file.name;
		var DataSave = new FormData();
		DataSave.append('FileCategory', "MAIN_DRAFT");
		DataSave.append('UPLOAD_FILE', file);

		$("#Saving_Load").show("fade", function () {

			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/UploadFilePre',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					w2alert("Upload File Gagal !");
					var file_input = $('#draft_contract_file');
					file_input.ace_file_input('reset_input');
					$("#Saving_Load").hide();
				}
			});

			if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
				var file_input = $('#draft_contract_file');
				file_input.ace_file_input('reset_input');
				w2alert("Upload File Gagal !");
				$("#Saving_Load").hide();

			}
			else {

				var row_upload = { ID: Simpan.responseJSON["Result"] };
				Upload_File_Main_Draft.push(row_upload);
				w2alert("Upload Draft Berhasil !");
				$("#Saving_Load").hide();

			}

		});


	});


	$('#draft_signed_1').ace_file_input({
		btn_choose: 'Browse',
		btn_change: null,
		no_icon: 'ace-icon fa fa-cloud-upload',
		droppable: true,
		thumbnail: '',
		no_file: 'Klik disini untuk reupload draft kontrak',
		before_remove: function () {

			Id = Upload_File_Signed_1[0].ID;
			Delete_File_Main_Draft = [];
			var row_delete = { ID: Id };
			Delete_File_Main_Draft.push(row_delete);

			var DataSave = new FormData();
			DataSave.append('FileCategory', "MAIN_DRAFT");
			DataSave.append('FileUploadList', JSON.stringify(Delete_File_Main_Draft));

			$("#Deleting_Load").show("fade", function () {
				var Simpan = $.ajax({
					url: URL_PTPR + '/EContract/DeleteFilePre',
					type: 'POST',
					data: DataSave,
					dataType: "json",
					cache: false,
					async: false,
					contentType: false,
					processData: false,
					error: function (request, status, error) {
						$("#Deleting_Load").hide();
						w2alert("Upload File Gagal !");
					}
				});
				if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
					$("#Deleting_Load").hide();
					w2alert("Upload File Gagal !");
					return false;
				}
				else {
					$("#Deleting_Load").hide();
					Upload_File_Signed_1 = [];
					w2alert("Draft Berhasil Dihapus!");
					var file_input = $('#draft_signed_1');
					file_input.ace_file_input('reset_input');
					return true;
				}
			})
		},
		preview_error: function (filename, error_code) {
		}
	}).on('change', function () {


		if (Upload_File_Signed_1.length > 0) {

			Id = Upload_File_Signed_1[0].ID;
			Delete_File_Main_Draft = [];
			var row_delete = { ID: Id };
			Delete_File_Main_Draft.push(row_delete);
			var DataSave = new FormData();
			DataSave.append('FileCategory', "MAIN_DRAFT");
			DataSave.append('FileUploadList', JSON.stringify(Delete_File_Main_Draft));

			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/DeleteFilePre',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					//$("#Deleting_Load").hide();
					//w2alert("Upload File Gagal !");
				}
			});
		}

		Upload_File_Signed_1 = [];
		var file = this.files[0];
		var file_name = file.name;
		var DataSave = new FormData();
		DataSave.append('FileCategory', "MAIN_DRAFT");
		DataSave.append('UPLOAD_FILE', file);

		$("#Saving_Load").show("fade", function () {

			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/UploadFilePre',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					w2alert("Upload File Gagal !");
					var file_input = $('#draft_signed_1');
					file_input.ace_file_input('reset_input');
					$("#Saving_Load").hide();
				}
			});

			if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
				var file_input = $('#draft_signed_1');
				file_input.ace_file_input('reset_input');
				w2alert("Upload File Gagal !");
				$("#Saving_Load").hide();

			}
			else {

				var row_upload = { ID: Simpan.responseJSON["Result"] };
				Upload_File_Signed_1.push(row_upload);
				w2alert("Upload Draft Berhasil !");
				$("#Saving_Load").hide();

			}

		});


	});


	$('#draft_signed_2').ace_file_input({

		btn_choose: 'Browse',
		btn_change: null,
		no_icon: 'ace-icon fa fa-cloud-upload',
		droppable: true,
		thumbnail: '',
		no_file: 'Klik disini untuk reupload draft kontrak',
		before_remove: function () {

			Id = Upload_File_Signed_2[0].ID;
			Delete_File_Main_Draft = [];
			var row_delete = { ID: Id };
			Delete_File_Main_Draft.push(row_delete);

			var DataSave = new FormData();
			DataSave.append('FileCategory', "MAIN_DRAFT");
			DataSave.append('FileUploadList', JSON.stringify(Delete_File_Main_Draft));

			$("#Deleting_Load").show("fade", function () {
				var Simpan = $.ajax({
					url: URL_PTPR + '/EContract/DeleteFilePre',
					type: 'POST',
					data: DataSave,
					dataType: "json",
					cache: false,
					async: false,
					contentType: false,
					processData: false,
					error: function (request, status, error) {
						$("#Deleting_Load").hide();
						w2alert("Upload File Gagal !");
					}
				});
				if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
					$("#Deleting_Load").hide();
					w2alert("Upload File Gagal !");
					return false;
				}
				else {
					$("#Deleting_Load").hide();
					Upload_File_Signed_2 = [];
					w2alert("Draft Berhasil Dihapus!");
					var file_input = $('#draft_signed_2');
					file_input.ace_file_input('reset_input');
					return true;
				}
			})
		},
		preview_error: function (filename, error_code) {
		}
	}).on('change', function () {

		if (Upload_File_Signed_2.length > 0) {

			Id = Upload_File_Signed_2[0].ID;
			Delete_File_Main_Draft = [];
			var row_delete = { ID: Id };
			Delete_File_Main_Draft.push(row_delete);
			var DataSave = new FormData();
			DataSave.append('FileCategory', "MAIN_DRAFT");
			DataSave.append('FileUploadList', JSON.stringify(Delete_File_Main_Draft));

			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/DeleteFilePre',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					//$("#Deleting_Load").hide();
					//w2alert("Upload File Gagal !");
				}
			});
		}

		Upload_File_Signed_2 = [];
		var file = this.files[0];
		var file_name = file.name;
		var DataSave = new FormData();
		DataSave.append('FileCategory', "MAIN_DRAFT");
		DataSave.append('UPLOAD_FILE', file);

		$("#Saving_Load").show("fade", function () {

			var Simpan = $.ajax({
				url: URL_PTPR + '/EContract/UploadFilePre',
				type: 'POST',
				data: DataSave,
				dataType: "json",
				cache: false,
				async: false,
				contentType: false,
				processData: false,
				error: function (request, status, error) {
					w2alert("Upload File Gagal !");
					var file_input = $('#draft_signed_2');
					file_input.ace_file_input('reset_input');
					$("#Saving_Load").hide();
				}
			});

			if (Simpan.responseJSON["Result"].toLocaleLowerCase().indexOf("error") != -1) {
				var file_input = $('#draft_signed_2');
				file_input.ace_file_input('reset_input');
				w2alert("Upload File Gagal !");
				$("#Saving_Load").hide();

			}
			else {

				var row_upload = { ID: Simpan.responseJSON["Result"] };
				Upload_File_Signed_2.push(row_upload);
				w2alert("Upload Draft Berhasil !");
				$("#Saving_Load").hide();

			}

		});


	});

	$('#EUnProcedural').click(function () {
		if ($(this).is(':checked')) {
			$('#ENeedCorrection').prop('checked', false);
		} 
	});

	$('#ENeedCorrection').click(function () {
		if ($(this).is(':checked')) {
			$('#EUnProcedural').prop('checked', false);
		}
	});

	$('#ETglKontrak').w2field('date', { format: 'yyyy/mm/dd' });

	routing_draft();

	

</script>